! ---------------------------------------------------------------------
! simple tension test w\ linear elastic P1-tetrahedral element
! ---------------------------------------------------------------------



!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
! allocation
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



!---initialization-----------------------------------------------------
FEAP * * tension test             ! name of the boundary value problem
  0     0     1      2   2   3    
! numnp numel nummat ndm ndf nen
! ---------------------------------------------------------------------
! INFO
! nump:........number of nodal points (0 = automatic)
! numel:.......number of elements (0 = automatic)
! nummat:......number of material property sets (0 = automatic)
! ndm:.........space dimension of mesh
! ndf:.........maximum number of dof per node
! nen:.........maximum number of nodes per element
! ---------------------------------------------------------------------



! ---set system parameters (user defined/optional)---------------------
para                ! start parameter set definition
  nx = 10           ! number of elements in x-direction
  ny = 10           ! number of elements in y-direction
  lx = 4            ! dimension in x-direction 
  ly = 4            ! dimension in y-direction 
  p0 = 1000         ! stress at the right boundary
  pp = p0*ly/ny     ! Load per node in each element
  E  = 210000       ! youngs modulus
  nu = 0.3          ! poisson ratio

 
 
! ---set material properties-------------------------------------------
mate 1             ! start definition of material set 1
  soli             ! FEAPpv solid element 
  elas isot E nu   ! material type and material parameters

  

  
! ---geometry allocation-----------------------------------------------
bloc 1            ! start geometry definition of patch 1          
  cart nx ny 1 1 1 0 6 ! type r-inc s-inc node1 elmt1 mat r-skip b-type
    1  0  0        ! x,y of master node 1
    2  lx 0          
    3  lx ly        
    4  0  ly        
! ---------------------------------------------------------------------
! INFO
! type:.....master node coordinate type (cart or pola)
! r-inc: ...number of elements in x-direction (here = nx)
! s-inc:....number of elements in y-direction (here = ny)
! node1:....number to be assigned to first generated node in patch 
! elmt1:....number to be assigned to first generated elemend in patch
! matl:.....material to be assigned to all elements in patch
! r-skip:...in 2D number of nodes to skip @ and of r-line 
! b-type:...element type and orientation
! ---------------------------------------------------------------------



! ---set essential boundary conditions---------------------------------
ebou                 
  1  0.0  1  1  
! i-coor xi-value ebx eby
! --------------------------------------------------------------------
! INFO
! i-coor:......scan direction (1=x,2=y)
! xi-value:....prescribe displacement @ xi-value in i-coor direction
! ebx,eby,ebz:.= 1: nodal dof constrained, = 0: nodal dof free
! ---------------------------------------------------------------------
  
  

! ---set natural boundary conditions------------------------------------
efor
  1      lx       pp 0  
! i-coor xi-value fx fy 
! ---------------------------------------------------------------------
! INFO
! fx,fy:...components of the force vector
! ---------------------------------------------------------------------

end    ! end allocation

tie    ! tie nodes (needed in case of multiple patches)



!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
! solution and postprocessing
!%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

batc  ! begin solution and postprocessing ('batch modus')

! ---solve linear global system----------------------------------------
  tang,,1        ! peform one newton iteration step
                 ! is equivalent to solve D=K^-1 R in the linear case

! ---print nodal displacements and element stresses in output----------
  disp,,(nx+1)*(ny+1)   ! print displacment data of upper right node
  disp all
  stre all
  
  
! ---plot mesh info and save in postscript file------------------------
! plot post    
! plot mesh     
! plot axis     ! axis coordinate system
! plot boun     ! Dirichlet boundarys
! plot load     ! Neumann boundarys
! plot node     ! plot all nodes
! plot post

! ---save sig11 stress in postscript file------------------------------
! plot post 
! plot defo   ! enter deformed configuration of the mesh (scaling =1)
! plot stre,1
! plot post
! ---save sig22 stress in postscript file------------------------------
! plot post 
! plot defo  ! enter deformed configuration of the mesh (scaling =1)
! plot stre,2,,1 
! plot post
! ---save sig33 stress in postscript file------------------------------
! plot post 
! plot defo   ! enter deformed configuration of the mesh (scaling =1)
! plot stre,3,,1 
! plot post
 
end    ! end solution and posprocessing ('batch modus')

inter  ! start interactive modus

stop
